name: pimgavir_viralgenomes
channels:
  - bioconda
  - conda-forge
  - defaults
dependencies:
  # ========================================
  # BASE ENVIRONMENT
  # ========================================
  - python=3.9
  - pip

  # ========================================
  # QUALITY CONTROL AND PREPROCESSING
  # ========================================
  - fastqc=0.12.1                   # Quality control reports
  - cutadapt=4.4                    # Adapter trimming
  - trim-galore=0.6.10              # Wrapper for quality trimming
  - bbmap=38.87                     # BBDuk for rRNA removal (faster than SortMeRNA)

  # ========================================
  # TAXONOMIC CLASSIFICATION
  # ========================================
  - kraken2                         # K-mer based taxonomic classification
  - kaiju                           # Protein-based taxonomic classification
  - krona                           # Interactive taxonomic visualization

  # ========================================
  # ASSEMBLY AND IMPROVEMENT
  # ========================================
  - megahit=1.2.9                   # Fast metagenomic assembler
  - spades=3.15.5                   # Sensitive metagenomic assembler
  - quast=5.2.0                     # Assembly quality assessment
  - bowtie2=2.5.1                   # Read alignment
  - samtools=1.17                   # SAM/BAM manipulation
  - pilon=1.24                      # Assembly polishing

  # ========================================
  # SEQUENCE ANALYSIS AND ANNOTATION
  # ========================================
  - blast=2.14.1                    # BLAST+ suite (includes makeblastdb, blastn, blastp, blastx)
  - diamond=2.1.8                   # Fast protein alignment (BLAST alternative)
  - prokka=1.14.6                   # Prokaryotic genome annotation
  - vsearch                         # Clustering and chimera detection
  - seqkit=2.5.1                    # FASTA/FASTQ manipulation
  - seqtk=1.3                       # FASTA/FASTQ processing

  # ========================================
  # UTILITIES
  # ========================================
  - taxonkit=0.15.1                 # NCBI taxonomy manipulation
  - parallel=20230522               # GNU parallel for job parallelization
  - rsync=3.2.7                     # File synchronization
  - wget=1.21.4                     # File downloads (HTTPS support)
  - curl                            # Alternative file downloader
  - pigz=2.6                        # Parallel gzip
  - pbzip2=1.1.13                   # Parallel bzip2
  - gzip                            # Standard gzip (for gunzip)
  - bzip2                           # Standard bzip2

  # ========================================
  # PROGRAMMING LANGUAGES AND LIBRARIES
  # ========================================
  - biopython=1.81                  # Python bioinformatics library
  - numpy                           # Numerical computing
  - pandas                          # Data manipulation and analysis
  - matplotlib                      # Plotting library
  - seaborn                         # Statistical data visualization
  - perl=5.32.1                     # Perl interpreter
  - perl-bioperl=1.7.8              # Perl bioinformatics toolkit
  - openjdk=11.0.15                 # Java runtime (required by Pilon, Prokka)

  # ========================================
  # HMMER AND PROFILE SEARCH TOOLS
  # ========================================
  - hmmer=3.3.2                     # Profile HMM search (used by DRAM, Pfam, KOfam)
  - infernal=1.1.4                  # RNA structure and sequence search
  - aragorn=1.2.41                  # tRNA and tmRNA detection
  - barrnap=0.9                     # Ribosomal RNA prediction
  - minced=0.4.2                    # CRISPR array identification
  - trnascan-se=2.0.12              # tRNA gene prediction

  # ========================================
  # VIRAL GENOME ANALYSIS - 7 PHASES
  # ========================================

  # Phase 1: Viral Genome Recovery
  # -------------------------------
  - virsorter=2                     # Viral sequence identification and classification
  - checkv                          # Viral genome quality and completeness assessment
  - prodigal                        # Gene prediction (standard, for CheckV)
  - prodigal-gv                     # Gene prediction optimized for giant viruses
  - vrhyme                          # Viral genome binning from metagenomes

  # Phase 2: Functional Annotation
  # -------------------------------
  - dram                            # Distilled and Refined Annotation of Metabolism
                                    # Includes: KOfam, Pfam, dbCAN, MEROPS, VOG annotation
  # Note: DRAM databases downloaded separately via setup_viral_databases.sh
  # Note: InterProScan removed - very large (~30 GB) and often unavailable via conda

  # Phase 3: Phylogenetic Analysis
  # -------------------------------
  - mafft                           # Multiple sequence alignment (fast and accurate)
  - trimal                          # Alignment trimming and automated selection
  - iqtree                          # Maximum likelihood phylogenetic inference (fast)
  - mrbayes                         # Bayesian phylogenetic inference (MCMC)
  - raxml-ng                        # Alternative ML phylogenetics (RAxML next generation)
  - fasttree                        # Approximate ML trees for large alignments

  # Phase 4: Comparative Genomics
  # ------------------------------
  - mmseqs2                         # Fast sequence clustering and search
  - cd-hit                          # Sequence clustering at different identity levels
  - vcontact2                       # Viral taxonomy through protein cluster networks
  - genomad                         # Viral identification and taxonomy annotation
  - mash                            # Fast genome and metagenome distance estimation

  # Phase 5: Host Prediction and Ecology
  # -------------------------------------
  # Host prediction tools already included:
  # - minced (CRISPR spacers)
  # - trnascan-se (tRNA matching)
  # - mash (k-mer composition)
  # - diamond/blast (protein homology)

  # Additional analysis tools
  - bedtools                        # Genome interval operations
  - emboss                          # European Molecular Biology Open Software Suite

  # ========================================
  # VISUALIZATION AND REPORTING
  # ========================================
  - r-base>=4.2                     # R statistical computing
  - r-ggplot2                       # Grammar of graphics plotting
  - r-dplyr                         # Data manipulation
  - r-tidyr                         # Data tidying
  - r-rmarkdown                     # Dynamic document generation
  - r-pheatmap                      # Pretty heatmaps
  - r-vegan                         # Community ecology analyses
  - r-ape                           # Phylogenetics and evolution in R

  # ========================================
  # PYTHON PACKAGES (via pip)
  # ========================================
  - pip:
    - biopython>=1.81               # Bioinformatics library (duplicate for pip deps)
    - networkx>=2.8                 # Network analysis (for vConTACT2)
    - scipy>=1.10                   # Scientific computing
    - scikit-learn>=1.2             # Machine learning
    - ete3>=3.1.2                   # Phylogenetic tree analysis and visualization
    - pysam>=0.21                   # SAM/BAM file handling
    - pyvcf3>=1.0.3                 # VCF file parsing
